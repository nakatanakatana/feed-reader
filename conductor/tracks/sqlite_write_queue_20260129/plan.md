# Implementation Plan: SQLite Write Queue Service

## Phase 1: Service Definition and Core Logic [checkpoint: a4f3146]
Define the core structures and the background worker logic for batching write operations.

- [x] Task: Define `WriteQueueJob` interface and specific job structs (e.g., `SaveItemsJob`). 1932589
- [x] Task: Implement `WriteQueueService` struct with internal channel and configuration (batch size, interval). 832a60b
- [x] Task: Implement the background worker loop handling both timer and count-based triggers. c9b0c54
- [x] Task: Implement graceful shutdown logic to flush the queue. 31e8383
- [ ] Task: Conductor - User Manual Verification 'Phase 1: Service Definition and Core Logic' (Protocol in workflow.md)

## Phase 2: Database Integration and Batch Processing [checkpoint: 8d07e59]
Implement the logic to execute batched jobs within a single transaction using the existing database store.

- [x] Task: Implement the execution logic for each job type within a transaction. 148be5f
- [x] Task: Integrate with the existing `Store` and `Queries` generated by `sqlc`. 05da0d6
- [x] Task: Add logging and error handling for failed batch operations. 05da0d6
- [x] Task: Conductor - User Manual Verification 'Phase 2: Database Integration and Batch Processing' (Protocol in workflow.md) 8d07e59

## Phase 3: Refactoring and Integration [checkpoint: b18a889]
Integrate the `WriteQueueService` into the existing application components (e.g., `FetcherService`).

- [x] Task: Initialize `WriteQueueService` in `main.go` and provide it to relevant services. d42c38f
- [x] Task: Refactor `FetcherService` to use `WriteQueueService` for saving items. e93a1be
- [x] Task: Verify overall system behavior and performance improvements. a60e084
- [x] Task: Conductor - User Manual Verification 'Phase 3: Refactoring and Integration' (Protocol in workflow.md) b18a889
